<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ Scheda del Personaggio D&D</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container-fluid p-3">
        <!-- Tabs Navigation -->
        <ul class="nav nav-tabs mb-3" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="sheet-tab" data-bs-toggle="tab" data-bs-target="#sheet" type="button">‚öîÔ∏è SCHEDA PERSONAGGIO</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="equip-tab" data-bs-toggle="tab" data-bs-target="#equip" type="button">üéí EQUIPAGGIAMENTO E APPUNTI</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="spells-tab" data-bs-toggle="tab" data-bs-target="#spells" type="button">‚ú® INCANTESIMI</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="scaling-tab" data-bs-toggle="tab" data-bs-target="#scaling" type="button">üìä SCALING ABILIT√Ä</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="dm-tab" data-bs-toggle="tab" data-bs-target="#dm" type="button">üé≠ DUNGEON MASTER</button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="mainTabContent">
            <!-- SCHEDA PERSONAGGIO -->
            <div class="tab-pane fade show active" id="sheet" role="tabpanel">
                <!-- Character Info -->
                <div class="card mb-3">
                    <div class="card-header bg-primary text-white">üèõÔ∏è INFORMAZIONI PERSONAGGIO</div>
                    <div class="card-body">
                        <div class="row g-2 mb-2">
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">Nome del Personaggio</label>
                                <input type="text" class="form-control form-control-sm" id="charName">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label small fw-bold">Classe</label>
                                <input type="text" class="form-control form-control-sm" id="charClass">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label small fw-bold">Razza</label>
                                <input type="text" class="form-control form-control-sm" id="charRace">
                            </div>
                            <div class="col-md-1">
                                <label class="form-label small fw-bold">Livello</label>
                                <input type="number" class="form-control form-control-sm" id="charLevel" value="1">
                            </div>
                            <div class="col-md-1">
                                <label class="form-label small fw-bold">Et√†</label>
                                <input type="text" class="form-control form-control-sm" id="charAge">
                            </div>
                            <div class="col-md-1">
                                <label class="form-label small fw-bold">Altezza</label>
                                <input type="text" class="form-control form-control-sm" id="charHeight">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label small fw-bold">Carnagione</label>
                                <input type="text" class="form-control form-control-sm" id="charSkin">
                            </div>
                        </div>
                        <div class="row g-2">
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">Background</label>
                                <input type="text" class="form-control form-control-sm" id="charBackground">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label small fw-bold">Allineamento</label>
                                <input type="text" class="form-control form-control-sm" id="charAlignment">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label small fw-bold">Punti Esperienza</label>
                                <input type="number" class="form-control form-control-sm" id="charXP" value="0">
                            </div>
                            <div class="col-md-1">
                                <label class="form-label small fw-bold">Peso</label>
                                <input type="text" class="form-control form-control-sm" id="charWeight">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label small fw-bold">Capelli</label>
                                <input type="text" class="form-control form-control-sm" id="charHair">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label small fw-bold">Occhi</label>
                                <input type="text" class="form-control form-control-sm" id="charEyes">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content Row -->
                <div class="row g-3">
                    <!-- Abilities Column -->
                    <div class="col-lg-3">
                        <div class="card mb-3">
                            <div class="card-header bg-info text-white">üí™ CARATTERISTICHE & TIRI SALVEZZA</div>
                            <div class="card-body">
                                <h6 class="text-center mb-2">PUNTEGGI CARATTERISTICA</h6>
                                <div id="abilitiesContainer"></div>
                                <hr>
                                <h6 class="text-center mb-2">TIRI SALVEZZA</h6>
                                <div id="savesContainer"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Combat Column -->
                    <div class="col-lg-3">
                        <div class="card mb-3">
                            <div class="card-header bg-warning text-dark">‚öîÔ∏è COMBATTIMENTO</div>
                            <div class="card-body">
                                <div class="row g-2 mb-2">
                                    <div class="col-4">
                                        <label class="form-label small fw-bold">‚ö° Iniziativa</label>
                                        <div class="stat-display" id="initiative">+0</div>
                                    </div>
                                    <div class="col-4">
                                        <label class="form-label small fw-bold">üèÉ Velocit√†</label>
                                        <input type="text" class="form-control form-control-sm text-center" id="speed" value="30">
                                    </div>
                                    <div class="col-4">
                                        <label class="form-label small fw-bold">Competenza</label>
                                        <input type="text" class="form-control form-control-sm text-center" id="profBonus" value="2">
                                    </div>
                                </div>
                                <div class="mb-2">
                                    <label class="form-label small fw-bold">Percezione Passiva</label>
                                    <div class="stat-display" id="passivePerception">10</div>
                                </div>
                                <div class="card mb-2 bg-danger text-white">
                                    <div class="card-body p-2">
                                        <h6 class="mb-2">‚ù§Ô∏è Punti Ferita</h6>
                                        <div class="row g-2">
                                            <div class="col-4">
                                                <label class="form-label small">Attuali</label>
                                                <input type="number" class="form-control form-control-sm text-center" id="hpCurrent" value="10">
                                            </div>
                                            <div class="col-4">
                                                <label class="form-label small">Massimi</label>
                                                <input type="number" class="form-control form-control-sm text-center" id="hpMax" value="10">
                                            </div>
                                            <div class="col-4">
                                                <label class="form-label small">Temp</label>
                                                <input type="number" class="form-control form-control-sm text-center" id="hpTemp" value="0">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row g-2 mb-2">
                                    <div class="col-4">
                                        <label class="form-label small fw-bold">üõ°Ô∏è CA</label>
                                        <input type="number" class="form-control form-control-sm text-center" id="ac" value="10">
                                    </div>
                                    <div class="col-4">
                                        <label class="form-label small fw-bold">CA Temp</label>
                                        <input type="number" class="form-control form-control-sm text-center" id="tempAC" value="0">
                                    </div>
                                    <div class="col-4">
                                        <label class="form-label small fw-bold">üé≤ Dadi Vita</label>
                                        <div class="input-group input-group-sm">
                                            <input type="number" class="form-control text-center" id="diceCurrent" value="1" style="max-width:30px;">
                                            <span class="input-group-text">/</span>
                                            <input type="number" class="form-control text-center" id="diceMax" value="1" style="max-width:30px;">
                                            <input type="text" class="form-control text-center" id="diceType" value="d8" style="max-width:40px;">
                                        </div>
                                    </div>
                                </div>
                                <div class="card mb-2">
                                    <div class="card-body p-2">
                                        <h6 class="mb-2">üíÄ TS contro MORTE</h6>
                                        <div class="row">
                                            <div class="col-6">
                                                <label class="form-label small text-success fw-bold">SUCCESSI</label>
                                                <div class="d-flex gap-1">
                                                    <input type="checkbox" class="death-save-success">
                                                    <input type="checkbox" class="death-save-success">
                                                    <input type="checkbox" class="death-save-success">
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <label class="form-label small text-danger fw-bold">FALLIMENTI</label>
                                                <div class="d-flex gap-1">
                                                    <input type="checkbox" class="death-save-failure">
                                                    <input type="checkbox" class="death-save-failure">
                                                    <input type="checkbox" class="death-save-failure">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-body p-2">
                                        <h6 class="mb-2">‚öîÔ∏è Armi</h6>
                                        <div class="weapons-header row g-1 mb-1 small fw-bold">
                                            <div class="col-5">Arma</div>
                                            <div class="col-3 text-center">Bonus</div>
                                            <div class="col-4">Danno</div>
                                        </div>
                                        <div id="weaponsContainer" class="weapons-list"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Skills Column -->
                    <div class="col-lg-3">
                        <div class="card mb-3">
                            <div class="card-header bg-success text-white">üéØ Abilit√†</div>
                            <div class="card-body p-2">
                                <div class="skills-header row g-1 mb-1 small fw-bold">
                                    <div class="col-6">Nome</div>
                                    <div class="col-2 text-center">Mod</div>
                                    <div class="col-2 text-center">C</div>
                                    <div class="col-2 text-center">M</div>
                                </div>
                                <div id="skillsContainer"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Image Column -->
                    <div class="col-lg-3">
                        <div class="card">
                            <div class="card-header bg-primary text-white">üñºÔ∏è Immagine Personaggio <span id="imageCounter">(0/0)</span></div>
                            <div class="card-body">
                                <div class="btn-group mb-2 w-100">
                                    <button class="btn btn-sm btn-primary" onclick="loadCharImage()">Carica</button>
                                    <button class="btn btn-sm btn-danger" onclick="clearCharImage()">Rimuovi</button>
                                    <button class="btn btn-sm btn-secondary" onclick="prevCharImage()">‚¨ÖÔ∏è</button>
                                    <button class="btn btn-sm btn-secondary" onclick="nextCharImage()">‚û°Ô∏è</button>
                                </div>
                                <div id="charImageContainer" class="image-container text-center">
                                    <p class="text-muted">Nessuna immagine caricata</p>
                                </div>
                                <input type="file" id="charImageInput" accept="image/*" multiple style="display:none;">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Save/Load Buttons -->
                <div class="text-end mt-3">
                    <button class="btn btn-danger" onclick="resetSheet()">üîÑ Reset</button>
                    <button class="btn btn-info" onclick="loadData()">üìÇ Carica</button>
                    <button class="btn btn-success" onclick="saveData()">üíæ Salva</button>
                    <button class="btn btn-success" onclick="saveDataAs()">üíæ Salva con nome</button>
                </div>
            </div>

            <!-- EQUIPAGGIAMENTO E APPUNTI -->
            <div class="tab-pane fade" id="equip" role="tabpanel">
                <div class="row g-3">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header bg-secondary text-white">üéí EQUIPAGGIAMENTO</div>
                            <div class="card-body">
                                <div class="mb-2">
                                    <button class="btn btn-sm btn-primary" onclick="addEquipmentItem()">‚ûï Aggiungi Oggetto</button>
                                </div>
                                <div class="equipment-header row g-1 mb-1 small fw-bold">
                                    <div class="col-5">Oggetto</div>
                                    <div class="col-2">Qnt</div>
                                    <div class="col-4">Uso/Note</div>
                                    <div class="col-1"></div>
                                </div>
                                <div id="equipmentContainer"></div>
                            </div>
                        </div>
                        
                        <div class="card mt-3">
                            <div class="card-header bg-warning text-dark">üí∞ MONETE</div>
                            <div class="card-body">
                                <div class="row g-2">
                                    <div class="col">
                                        <label class="form-label small fw-bold">MR (Rame)</label>
                                        <input type="number" class="form-control form-control-sm" id="coinMR" value="0">
                                    </div>
                                    <div class="col">
                                        <label class="form-label small fw-bold">MA (Argento)</label>
                                        <input type="number" class="form-control form-control-sm" id="coinMA" value="0">
                                    </div>
                                    <div class="col">
                                        <label class="form-label small fw-bold">ME (Elettro)</label>
                                        <input type="number" class="form-control form-control-sm" id="coinME" value="0">
                                    </div>
                                    <div class="col">
                                        <label class="form-label small fw-bold">MO (Oro)</label>
                                        <input type="number" class="form-control form-control-sm" id="coinMO" value="0">
                                    </div>
                                    <div class="col">
                                        <label class="form-label small fw-bold">MP (Platino)</label>
                                        <input type="number" class="form-control form-control-sm" id="coinMP" value="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="card mb-3">
                            <div class="card-header bg-info text-white">üìú TRATTI & CARATTERISTICHE</div>
                            <div class="card-body">
                                <textarea class="form-control" id="featuresTraits" rows="10" placeholder="Inserisci tratti, privilegi di classe, background..."></textarea>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header bg-primary text-white">üìù APPUNTI GIOCATORE</div>
                            <div class="card-body">
                                <textarea class="form-control" id="playerNotes" rows="10" placeholder="Appunti personali..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- INCANTESIMI -->
            <div class="tab-pane fade" id="spells" role="tabpanel">
                <div class="row g-3">
                    <div class="col-lg-8">
                        <div class="card mb-3">
                            <div class="card-header bg-info text-white">üìñ CAPACIT√Ä INCANTESIMI</div>
                            <div class="card-body">
                                <div class="row g-2">
                                    <div class="col-md-2">
                                        <label class="form-label small fw-bold">Caratteristica</label>
                                        <select class="form-select form-select-sm" id="spellAbility">
                                            <option value="">-</option>
                                            <option value="FOR">FOR</option>
                                            <option value="DES">DES</option>
                                            <option value="COS">COS</option>
                                            <option value="INT">INT</option>
                                            <option value="SAG">SAG</option>
                                            <option value="CAR">CAR</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label small fw-bold">CD Tiro Salv.</label>
                                        <input type="text" class="form-control form-control-sm" id="spellSaveDC" value="+0">
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label small fw-bold">Bonus Attacco</label>
                                        <input type="text" class="form-control form-control-sm" id="spellAttackBonus" value="+0">
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label small fw-bold">Incant. Conosciuti</label>
                                        <input type="number" class="form-control form-control-sm" id="spellsKnown" value="0">
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label small fw-bold">Incant. Preparati</label>
                                        <input type="number" class="form-control form-control-sm" id="spellsPrepared" value="0">
                                    </div>
                                    <div class="col-md-2">
                                        <label class="form-label small fw-bold">Trucchetti Conosciuti</label>
                                        <input type="number" class="form-control form-control-sm" id="cantripsKnown" value="0">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Cantrips -->
                        <div class="card mb-3">
                            <div class="card-header bg-secondary text-white">‚ú® TRUCCHETTI</div>
                            <div class="card-body">
                                <div id="cantripsContainer"></div>
                            </div>
                        </div>

                        <!-- Spell Levels -->
                        <div id="spellLevelsContainer"></div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-header bg-warning text-dark">üé∞ SLOT INCANTESIMI</div>
                            <div class="card-body">
                                <div id="spellSlotsContainer"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SCALING ABILIT√Ä -->
            <div class="tab-pane fade" id="scaling" role="tabpanel">
                <div class="card">
                    <div class="card-header bg-primary text-white">üìä SCALING ABILIT√Ä</div>
                    <div class="card-body">
                        <p class="text-muted">Personalizza quale caratteristica usa ogni abilit√† per il calcolo del modificatore.</p>
                        <div id="scalingContainer" class="row g-3"></div>
                    </div>
                </div>
            </div>

            <!-- DUNGEON MASTER -->
            <div class="tab-pane fade" id="dm" role="tabpanel">
                <div class="row g-3">
                    <div class="col-lg-6">
                        <div class="card mb-3">
                            <div class="card-header bg-secondary text-white">üìù Appunti DM</div>
                            <div class="card-body">
                                <textarea class="form-control" id="dmNotes" rows="10" placeholder="Appunti del Dungeon Master..."></textarea>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header bg-info text-white">üé≤ Comandi Dadi</div>
                            <div class="card-body">
                                <div class="input-group mb-2">
                                    <input type="text" class="form-control" id="diceCommand" placeholder="es: 2d6+4">
                                    <button class="btn btn-primary" onclick="rollDice()">Tira</button>
                                </div>
                                <div class="btn-group mb-2 w-100" role="group">
                                    <button class="btn btn-sm btn-outline-info" onclick="quickRoll('1d4')">d4</button>
                                    <button class="btn btn-sm btn-outline-info" onclick="quickRoll('1d6')">d6</button>
                                    <button class="btn btn-sm btn-outline-info" onclick="quickRoll('1d8')">d8</button>
                                    <button class="btn btn-sm btn-outline-info" onclick="quickRoll('1d10')">d10</button>
                                    <button class="btn btn-sm btn-outline-info" onclick="quickRoll('1d12')">d12</button>
                                    <button class="btn btn-sm btn-outline-info" onclick="quickRoll('1d20')">d20</button>
                                    <button class="btn btn-sm btn-outline-info" onclick="quickRoll('1d100')">d100</button>
                                </div>
                                <button class="btn btn-sm btn-light w-100 mb-2" onclick="showDiceHelp()">‚ùì Sintassi Dadi</button>
                                <div class="bg-dark text-white p-2" style="height: 150px; overflow-y: auto; font-family: monospace; font-size: 0.9em;" id="diceLog"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="card mb-3">
                            <div class="card-header bg-primary text-white">üñºÔ∏è Galleria Immagini DM <span id="dmImageCounter">(0/0)</span></div>
                            <div class="card-body">
                                <div class="btn-group mb-2 w-100">
                                    <button class="btn btn-sm btn-primary" onclick="addDMImage()">üìÅ Aggiungi</button>
                                    <button class="btn btn-sm btn-danger" onclick="removeDMImage()">üóëÔ∏è Rimuovi</button>
                                    <button class="btn btn-sm btn-secondary" onclick="prevDMImage()">‚¨ÖÔ∏è</button>
                                    <button class="btn btn-sm btn-secondary" onclick="nextDMImage()">‚û°Ô∏è</button>
                                </div>
                                <div id="dmImageContainer" class="image-container text-center">
                                    <p class="text-muted">Nessuna immagine selezionata</p>
                                </div>
                                <input type="file" id="dmImageInput" accept="image/*" multiple style="display:none;">
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header bg-info text-white">üìä Statistiche NPC</div>
                            <div class="card-body">
                                <div class="row g-2 mb-3">
                                    <div class="col-3">
                                        <label class="form-label small fw-bold">HP</label>
                                        <input type="number" class="form-control form-control-sm" id="dmHP" value="0">
                                    </div>
                                    <div class="col-3">
                                        <label class="form-label small fw-bold">CA</label>
                                        <input type="number" class="form-control form-control-sm" id="dmAC" value="0">
                                    </div>
                                    <div class="col-3">
                                        <label class="form-label small fw-bold">Iniziativa</label>
                                        <input type="text" class="form-control form-control-sm" id="dmInitiative" value="+0">
                                    </div>
                                    <div class="col-3">
                                        <label class="form-label small fw-bold">Competenza</label>
                                        <input type="text" class="form-control form-control-sm" id="dmProf" value="2">
                                    </div>
                                </div>
                                <h6 class="mb-2">Caratteristiche</h6>
                                <div id="dmAbilitiesContainer" class="row g-2"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
